# Claude Code 개발 지침서

## 프로젝트 개요
랜덤 조 편성기 (Team Randomizer) - N명의 참가자를 4개 조에 공정하게 랜덤 배분하는 웹 애플리케이션

---

## 핵심 개발 원칙

### 1. Kent Beck의 TDD (Test-Driven Development)

본 프로젝트는 Kent Beck이 정립한 TDD 방법론을 엄격히 준수한다.

#### 1.1 Red-Green-Refactor 사이클

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│    ┌─────────┐      ┌─────────┐      ┌─────────────┐       │
│    │   RED   │ ───▶ │  GREEN  │ ───▶ │  REFACTOR   │       │
│    │ (실패)  │      │ (통과)  │      │ (개선)      │       │
│    └─────────┘      └─────────┘      └─────────────┘       │
│         │                                    │              │
│         └────────────────────────────────────┘              │
│                     (반복)                                  │
└─────────────────────────────────────────────────────────────┘
```

**RED (실패하는 테스트 작성)**
- 구현 전에 반드시 테스트를 먼저 작성한다
- 테스트는 명확한 실패 메시지를 출력해야 한다
- 한 번에 하나의 기능만 테스트한다

**GREEN (테스트를 통과하는 최소한의 코드)**
- 테스트를 통과시키는 가장 단순한 코드를 작성한다
- "작동하는 코드"가 최우선 목표다
- 과도한 설계나 최적화를 피한다

**REFACTOR (코드 개선)**
- 테스트가 통과한 후에만 리팩토링한다
- 중복을 제거하고 가독성을 높인다
- 리팩토링 후에도 모든 테스트가 통과해야 한다

#### 1.2 TDD 핵심 규칙

| 규칙 | 설명 |
|------|------|
| **테스트 우선** | 프로덕션 코드 작성 전 실패하는 테스트 필수 |
| **단일 실패** | 한 번에 하나의 실패하는 테스트만 존재 |
| **최소 구현** | 테스트 통과에 필요한 최소한의 코드만 작성 |
| **지속적 리팩토링** | 모든 Green 단계 후 리팩토링 검토 |

#### 1.3 테스트 계층

```
┌─────────────────────────────────────┐
│          E2E Tests                  │  ← Playwright MCP (시각적 검증)
│    (End-to-End / UI Tests)          │
├─────────────────────────────────────┤
│       Integration Tests             │  ← 컴포넌트 간 상호작용
├─────────────────────────────────────┤
│          Unit Tests                 │  ← 순수 함수 테스트
│    (Fisher-Yates, 배분 로직 등)      │
└─────────────────────────────────────┘
```

---

### 2. Agentic Coding 방법론

AI 에이전트(Claude)가 자율적으로 개발을 수행하되, 체계적인 검증 루프를 통해 품질을 보장한다.

#### 2.1 Agentic 개발 사이클

```
┌──────────────────────────────────────────────────────────────────┐
│                                                                  │
│   ┌────────────┐    ┌────────────┐    ┌────────────┐            │
│   │  PLAN      │───▶│  EXECUTE   │───▶│  VERIFY    │            │
│   │ (계획)     │    │ (실행)     │    │ (검증)     │            │
│   └────────────┘    └────────────┘    └────────────┘            │
│         │                                    │                   │
│         │           ┌────────────┐           │                   │
│         └───────────│  ITERATE   │◀──────────┘                   │
│                     │ (반복/개선) │                               │
│                     └────────────┘                               │
└──────────────────────────────────────────────────────────────────┘
```

#### 2.2 자율 검증 체크포인트

| 단계 | 검증 항목 | 도구 |
|------|----------|------|
| 코드 작성 후 | 문법 오류, 타입 체크 | IDE Diagnostics |
| 기능 구현 후 | 단위 테스트 실행 | Jest / 브라우저 콘솔 |
| UI 변경 후 | 시각적 검증 | Playwright MCP 스크린샷 |
| 통합 후 | E2E 테스트 | Playwright MCP |

#### 2.3 실시간 피드백 루프

에이전트는 각 작업 단계에서 즉각적인 피드백을 수집하고 반영한다:

1. **코드 변경** → 즉시 브라우저에서 확인
2. **UI 렌더링** → Playwright 스크린샷으로 시각적 검증
3. **기능 동작** → 콘솔 로그 및 네트워크 요청 확인
4. **오류 발생** → 즉시 수정 및 재검증

---

### 3. Context7 MCP 활용 지침

최신 라이브러리 문서와 코드 예제를 실시간으로 참조하여 정확한 구현을 보장한다.

#### 3.1 활용 시점

| 상황 | Context7 활용 방법 |
|------|-------------------|
| 라이브러리 API 불확실 | `resolve-library-id` → `query-docs` |
| 최신 문법 확인 | 해당 라이브러리 문서 조회 |
| 코드 예제 필요 | 구체적 query로 예제 검색 |
| 버전 호환성 확인 | 특정 버전 문서 조회 |

#### 3.2 활용 프로세스

```
1. resolve-library-id 호출
   └── libraryName: "playwright" (또는 필요한 라이브러리)
   └── query: "사용하려는 기능 설명"

2. query-docs 호출
   └── libraryId: 위에서 얻은 ID
   └── query: "구체적인 질문 또는 기능"

3. 문서 내용 기반으로 정확한 코드 작성
```

#### 3.3 본 프로젝트에서의 활용

- **Playwright**: E2E 테스트 작성 시 최신 API 참조
- **CSS/HTML**: 최신 웹 표준 및 브라우저 호환성 확인
- **JavaScript**: ES6+ 문법 및 Web API 참조

---

### 4. Playwright MCP 활용 지침

브라우저 자동화를 통한 실제 화면 검증으로 UI/UX 품질을 보장한다.

#### 4.1 핵심 활용 도구

| 도구 | 용도 |
|------|------|
| `browser_navigate` | 개발 중인 페이지 접속 |
| `browser_snapshot` | 접근성 트리 기반 페이지 상태 확인 |
| `browser_take_screenshot` | 시각적 검증용 스크린샷 캡처 |
| `browser_click` | UI 인터랙션 테스트 |
| `browser_type` | 입력 필드 테스트 |
| `browser_console_messages` | JavaScript 오류 확인 |

#### 4.2 시각적 검증 프로세스

```
┌─────────────────────────────────────────────────────────────┐
│                    시각적 검증 플로우                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 로컬 서버 실행 (또는 file:// 프로토콜)                   │
│         ↓                                                   │
│  2. browser_navigate로 페이지 접속                          │
│         ↓                                                   │
│  3. browser_snapshot으로 페이지 구조 확인                   │
│         ↓                                                   │
│  4. browser_take_screenshot으로 현재 상태 캡처              │
│         ↓                                                   │
│  5. 스크린샷 분석 및 UI 검증                                │
│         ↓                                                   │
│  6. 문제 발견 시 수정 후 2번부터 반복                       │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### 4.3 검증 체크리스트

**레이아웃 검증**
- [ ] 요소들이 의도한 위치에 배치되었는가?
- [ ] 반응형 레이아웃이 올바르게 작동하는가?
- [ ] 요소 간 간격과 정렬이 일관적인가?

**기능 검증**
- [ ] 버튼 클릭 시 예상된 동작이 수행되는가?
- [ ] 입력 필드가 정상적으로 동작하는가?
- [ ] 결과가 올바르게 표시되는가?

**시각적 검증**
- [ ] 색상과 폰트가 디자인 명세와 일치하는가?
- [ ] 아이콘과 이미지가 올바르게 표시되는가?
- [ ] 호버/액티브 상태가 적용되는가?

#### 4.4 E2E 테스트 시나리오

```javascript
// 예시: 조 편성 기능 E2E 테스트 흐름
1. browser_navigate → index.html 접속
2. browser_snapshot → 초기 상태 확인
3. browser_click → "조 편성하기" 버튼 클릭
4. browser_snapshot → 결과 영역 확인
5. browser_take_screenshot → 결과 화면 캡처
6. 검증: 4개 조가 모두 표시되고, 인원이 균등 배분되었는지 확인
```

---

### 5. 개발 워크플로우 통합

TDD, Agentic Coding, Context7, Playwright를 통합한 개발 흐름:

```
┌─────────────────────────────────────────────────────────────────┐
│                       통합 개발 워크플로우                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 1. 요구사항 분석                                         │   │
│  │    └── PRD 확인, 구현할 기능 선정                        │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 2. Context7로 필요한 기술 문서 조회                      │   │
│  │    └── 최신 API, 코드 예제 확인                          │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 3. RED: 실패하는 테스트 작성                             │   │
│  │    └── 기능 명세를 테스트 코드로 표현                    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 4. GREEN: 테스트 통과하는 최소 코드 작성                 │   │
│  │    └── 가장 단순한 구현                                  │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 5. Playwright MCP로 시각적 검증                          │   │
│  │    └── 스크린샷 캡처, UI 상태 확인                       │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 6. REFACTOR: 코드 개선                                   │   │
│  │    └── 중복 제거, 가독성 향상, 테스트 유지               │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 7. 전체 테스트 실행 및 최종 스크린샷 검증                │   │
│  │    └── 회귀 테스트, 시각적 회귀 확인                     │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│                    다음 기능으로 반복                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### 6. 커밋 규칙

TDD 사이클에 맞춘 커밋 전략:

| 단계 | 커밋 메시지 형식 | 예시 |
|------|-----------------|------|
| RED | `test: <테스트 설명>` | `test: 조 편성 버튼 클릭 테스트 추가` |
| GREEN | `feat: <기능 설명>` | `feat: 조 편성 기능 구현` |
| REFACTOR | `refactor: <개선 내용>` | `refactor: 셔플 함수 분리` |
| 버그 수정 | `fix: <수정 내용>` | `fix: 균등 배분 오류 수정` |
| 스타일 | `style: <스타일 변경>` | `style: 결과 카드 레이아웃 개선` |

---

### 7. 품질 기준

| 항목 | 기준 |
|------|------|
| 테스트 커버리지 | 핵심 로직 100% |
| 시각적 검증 | 모든 UI 변경 시 스크린샷 확인 |
| 콘솔 오류 | 0개 |
| 접근성 | 키보드 네비게이션 지원 |
| 성능 | 2,000회 시뮬레이션 3초 이내 |

---

## 파일 구조

```
team-randomizer/
├── index.html          # 메인 HTML
├── style.css           # 스타일시트
├── script.js           # 메인 로직
├── tests/
│   └── test.js         # 테스트 코드
├── screenshots/        # Playwright 스크린샷 저장
├── claude.md           # 이 파일 (개발 지침)
├── PRD.md              # 제품 요구사항 문서
└── README.md           # 프로젝트 설명
```
